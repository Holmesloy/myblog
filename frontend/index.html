<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript | 进阶</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/myBlog/cc.png">
    <meta name="description" content="学习笔记">
    <link rel="preload" href="/myBlog/assets/css/0.styles.8a57e611.css" as="style"><link rel="preload" href="/myBlog/assets/js/app.e2a5d604.js" as="script"><link rel="preload" href="/myBlog/assets/js/3.8a7523f6.js" as="script"><link rel="preload" href="/myBlog/assets/js/1.015dc369.js" as="script"><link rel="preload" href="/myBlog/assets/js/52.c3bc0832.js" as="script"><link rel="prefetch" href="/myBlog/assets/js/10.7b1b0431.js"><link rel="prefetch" href="/myBlog/assets/js/11.d26e9a40.js"><link rel="prefetch" href="/myBlog/assets/js/12.ad86edaf.js"><link rel="prefetch" href="/myBlog/assets/js/13.b6ddd56e.js"><link rel="prefetch" href="/myBlog/assets/js/14.9325d2fa.js"><link rel="prefetch" href="/myBlog/assets/js/15.e91821a3.js"><link rel="prefetch" href="/myBlog/assets/js/16.aae430a7.js"><link rel="prefetch" href="/myBlog/assets/js/17.2293bccf.js"><link rel="prefetch" href="/myBlog/assets/js/18.3a2d69c2.js"><link rel="prefetch" href="/myBlog/assets/js/19.21fb125c.js"><link rel="prefetch" href="/myBlog/assets/js/20.65b7b522.js"><link rel="prefetch" href="/myBlog/assets/js/21.28eaba47.js"><link rel="prefetch" href="/myBlog/assets/js/22.aff7fda6.js"><link rel="prefetch" href="/myBlog/assets/js/23.c602883e.js"><link rel="prefetch" href="/myBlog/assets/js/24.594933e4.js"><link rel="prefetch" href="/myBlog/assets/js/25.55bdb4c3.js"><link rel="prefetch" href="/myBlog/assets/js/26.e4b56c42.js"><link rel="prefetch" href="/myBlog/assets/js/27.7723c24c.js"><link rel="prefetch" href="/myBlog/assets/js/28.32f098cb.js"><link rel="prefetch" href="/myBlog/assets/js/29.60da25c4.js"><link rel="prefetch" href="/myBlog/assets/js/30.37b3a9da.js"><link rel="prefetch" href="/myBlog/assets/js/31.323fd96d.js"><link rel="prefetch" href="/myBlog/assets/js/32.1ab6f4c6.js"><link rel="prefetch" href="/myBlog/assets/js/33.8d544844.js"><link rel="prefetch" href="/myBlog/assets/js/34.4138dd44.js"><link rel="prefetch" href="/myBlog/assets/js/35.11e392dd.js"><link rel="prefetch" href="/myBlog/assets/js/36.c46ef8b9.js"><link rel="prefetch" href="/myBlog/assets/js/37.75e4735d.js"><link rel="prefetch" href="/myBlog/assets/js/38.072d7b78.js"><link rel="prefetch" href="/myBlog/assets/js/39.995eb93d.js"><link rel="prefetch" href="/myBlog/assets/js/4.44cbef6d.js"><link rel="prefetch" href="/myBlog/assets/js/40.24090d6b.js"><link rel="prefetch" href="/myBlog/assets/js/41.adbf0a9c.js"><link rel="prefetch" href="/myBlog/assets/js/42.97dbaef6.js"><link rel="prefetch" href="/myBlog/assets/js/43.7ccae9bb.js"><link rel="prefetch" href="/myBlog/assets/js/44.4aded0ce.js"><link rel="prefetch" href="/myBlog/assets/js/45.d0d85797.js"><link rel="prefetch" href="/myBlog/assets/js/46.be569ca1.js"><link rel="prefetch" href="/myBlog/assets/js/47.8f73e39d.js"><link rel="prefetch" href="/myBlog/assets/js/48.e8a54dca.js"><link rel="prefetch" href="/myBlog/assets/js/49.8f61a5f4.js"><link rel="prefetch" href="/myBlog/assets/js/5.12015b3b.js"><link rel="prefetch" href="/myBlog/assets/js/50.7209d829.js"><link rel="prefetch" href="/myBlog/assets/js/51.ab4ee2db.js"><link rel="prefetch" href="/myBlog/assets/js/53.d5a56b90.js"><link rel="prefetch" href="/myBlog/assets/js/54.f65f0712.js"><link rel="prefetch" href="/myBlog/assets/js/55.160b9312.js"><link rel="prefetch" href="/myBlog/assets/js/56.46a7734a.js"><link rel="prefetch" href="/myBlog/assets/js/57.99a2b252.js"><link rel="prefetch" href="/myBlog/assets/js/58.a316dab3.js"><link rel="prefetch" href="/myBlog/assets/js/59.4bf8ed70.js"><link rel="prefetch" href="/myBlog/assets/js/6.4d13203e.js"><link rel="prefetch" href="/myBlog/assets/js/60.1e83d145.js"><link rel="prefetch" href="/myBlog/assets/js/61.9fa35932.js"><link rel="prefetch" href="/myBlog/assets/js/62.2e3408ea.js"><link rel="prefetch" href="/myBlog/assets/js/7.77c77d24.js"><link rel="prefetch" href="/myBlog/assets/js/8.37d401c0.js"><link rel="prefetch" href="/myBlog/assets/js/9.711da3e2.js">
    <link rel="stylesheet" href="/myBlog/assets/css/0.styles.8a57e611.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-9f1e2f90><div data-v-9f1e2f90><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-9f1e2f90 data-v-9f1e2f90><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-58d5ab76 data-v-9f1e2f90 data-v-9f1e2f90><h3 class="title" style="display:none;" data-v-58d5ab76 data-v-58d5ab76>进阶</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><input type="password" value="" data-v-58d5ab76> <span data-v-58d5ab76>Konck! Knock!</span> <button data-v-58d5ab76>OK</button></label> <div class="footer" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><span data-v-58d5ab76><i class="iconfont reco-theme" data-v-58d5ab76></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-58d5ab76>vuePress-theme-reco</a></span> <span data-v-58d5ab76><i class="iconfont reco-copyright" data-v-58d5ab76></i> <a data-v-58d5ab76><span data-v-58d5ab76>R-Z</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-9f1e2f90><header class="navbar" data-v-9f1e2f90><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myBlog/" class="home-link router-link-active"><img src="/myBlog/cc.png" alt="进阶" class="logo"> <span class="site-name">进阶</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myBlog/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/categories/布局/" class="nav-link"><i class="iconfont undefined"></i>
  布局
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/frontEnd/" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/网络/" class="nav-link"><i class="iconfont undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/编程/" class="nav-link"><i class="iconfont undefined"></i>
  编程
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/tools/" class="nav-link"><i class="iconfont undefined"></i>
  tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/面试/" class="nav-link"><i class="iconfont undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/智能/" class="nav-link"><i class="iconfont undefined"></i>
  智能
</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/myBlog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/myBlog/frontend/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  前端知识
</a></div><div class="nav-item"><a href="/myBlog/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  算法
</a></div><div class="nav-item"><a href="/myBlog/project/" class="nav-link"><i class="iconfont undefined"></i>
  项目
</a></div><div class="nav-item"><a href="/myBlog/notes/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></div><div class="nav-item"><a href="/myBlog/blog/" class="nav-link"><i class="iconfont undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/language/chinese.html" class="nav-link"><i class="iconfont undefined"></i>
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/language/English.html" class="nav-link"><i class="iconfont undefined"></i>
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-9f1e2f90></div> <aside class="sidebar" data-v-9f1e2f90><div class="personal-info-wrapper" data-v-3eba7259 data-v-9f1e2f90><!----> <h3 class="name" data-v-3eba7259>
    R-Z
  </h3> <div class="num" data-v-3eba7259><div data-v-3eba7259><h3 data-v-3eba7259>26</h3> <h6 data-v-3eba7259>Article</h6></div> <div data-v-3eba7259><h3 data-v-3eba7259>13</h3> <h6 data-v-3eba7259>Tag</h6></div></div> <hr data-v-3eba7259></div> <nav class="nav-links"><div class="nav-item"><a href="/myBlog/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/categories/布局/" class="nav-link"><i class="iconfont undefined"></i>
  布局
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/frontEnd/" class="nav-link"><i class="iconfont undefined"></i>
  frontEnd
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/网络/" class="nav-link"><i class="iconfont undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/编程/" class="nav-link"><i class="iconfont undefined"></i>
  编程
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/tools/" class="nav-link"><i class="iconfont undefined"></i>
  tools
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/面试/" class="nav-link"><i class="iconfont undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/categories/智能/" class="nav-link"><i class="iconfont undefined"></i>
  智能
</a></li></ul></div></div><div class="nav-item"><a href="/myBlog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/myBlog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/myBlog/frontend/" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  前端知识
</a></div><div class="nav-item"><a href="/myBlog/algorithm/" class="nav-link"><i class="iconfont undefined"></i>
  算法
</a></div><div class="nav-item"><a href="/myBlog/project/" class="nav-link"><i class="iconfont undefined"></i>
  项目
</a></div><div class="nav-item"><a href="/myBlog/notes/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></div><div class="nav-item"><a href="/myBlog/blog/" class="nav-link"><i class="iconfont undefined"></i>
  文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      Languages
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myBlog/language/chinese.html" class="nav-link"><i class="iconfont undefined"></i>
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myBlog/language/English.html" class="nav-link"><i class="iconfont undefined"></i>
  English
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/myBlog/frontend/" aria-current="page" class="active sidebar-link">JS</a></li><li><a href="/myBlog/frontend/es6.html" class="sidebar-link">ES6</a></li><li><a href="/myBlog/frontend/typescript.html" class="sidebar-link">TS</a></li><li><a href="/myBlog/frontend/html.html" class="sidebar-link">HTML</a></li><li><a href="/myBlog/frontend/css.html" class="sidebar-link">CSS</a></li><li><a href="/myBlog/frontend/http.html" class="sidebar-link">HTTP</a></li><li><a href="/myBlog/frontend/browser.html" class="sidebar-link">浏览器</a></li><li><a href="/myBlog/frontend/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/myBlog/frontend/vue.html" class="sidebar-link">Vue</a></li><li><a href="/myBlog/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/myBlog/frontend/mobile.html" class="sidebar-link">移动Web开发</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-58d5ab76 data-v-9f1e2f90><h3 class="title" style="display:none;" data-v-58d5ab76 data-v-58d5ab76></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><input type="password" value="" data-v-58d5ab76> <span data-v-58d5ab76>Konck! Knock!</span> <button data-v-58d5ab76>OK</button></label> <div class="footer" style="display:none;" data-v-58d5ab76 data-v-58d5ab76><span data-v-58d5ab76><i class="iconfont reco-theme" data-v-58d5ab76></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-58d5ab76>vuePress-theme-reco</a></span> <span data-v-58d5ab76><i class="iconfont reco-copyright" data-v-58d5ab76></i> <a data-v-58d5ab76><span data-v-58d5ab76>R-Z</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-9f1e2f90><main class="page"><div class="page-title" style="display:none;"><h1 class="title">JavaScript</h1> <div data-v-42458482><i class="iconfont reco-account" data-v-42458482><span data-v-42458482>R-Z</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="javascript"><a href="#javascript" class="header-anchor">#</a> JavaScript</h1> <h2 id="defer和async"><a href="#defer和async" class="header-anchor">#</a> defer和async</h2> <p>一般来说，当浏览器遇到<code>&lt;script&gt;</code>标签时，会暂停HTML文档解析，然后去下载并立即执行脚本，脚本执行完成再继续HTML文档解析。<br> <code>defer</code>和<code>async</code>都是<code>&lt;script&gt;</code>标签属性，都用于外部脚本文件。<br> <code>async</code>：异步加载脚本，即脚本下载和HTML解析是并行的，脚本一旦下载完成会立即执行，暂停文档解析，脚本执行顺序不能保证按序执行，不一定在DOMContentLoaded事件触发之前完成，但一定在load事件之前执行。<br> <code>defer</code>：延迟执行脚本，下载和HTML解析并行完成，但是等到页面文档解析完成之后执行，即全程不阻塞文档解析，脚本执行顺序与位置一致，在DOMContentLoaded事件触发之前完成。<br> <strong>总结：</strong><code>defer</code>和<code>async</code>下载都是异步进行的，只是执行时间和顺序有区别，其实最佳实践是将脚本放到body最下面，保证其他元素能以最快速度进行加载和解析。</p> <h2 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h2> <p>JS共7种数据类型：基本数据类型和一种引用数据类型（Object）。<br>
6种基本数据类型：<code>Undefined</code>，<code>Null</code>，<code>Boolean</code>，<code>Number</code>，<code>String</code>，<code>Symbol</code>。<br>
其中，<code>Null</code>比较特殊，可以看作一个特殊的引用类型，它保存一个空对象指针null。</p> <p><code>Undefined</code>：唯一值，即undefined，当<strong>变量声明但未初始化</strong>时，变量值即为undefined。<br> <code>Null</code>：唯一值，即null，表示一个空对象指针。<code>typeof(null)</code>返回&quot;object&quot;。<br> <code>Boolean</code>：true or false，以下值类型转换为false：<code>&quot;&quot;, 0和NaN, null, undefined</code>。<strong>注意：<code>&quot;0&quot;</code>会转化为true</strong>。<br> <code>Number</code>：最大值<strong>Number.MAX_VALUE</strong>，其中NaN与任何值都不相等，包括自己，使用<code>isNaN()</code>判断是否可以转换为数子类型。数值转换方法：<code>Number()</code>, <code>parseInt()</code>, <code>parseFloat()</code>。<strong>注：任意值与布尔值比较，都会将两边的值先转化为Number。</strong><br> <code>String</code>：可以用单引号和双引号，转换为字符串：<code>toString()</code> 或者 + &quot;&quot; 。<br> <code>Symbol</code>：表示唯一值，使用Symbol()创建：<code>const s = Symbol('hi')</code>，参数可选，常用作对象的唯一属性名</p> <p><code>Object类型</code>：<code>var o = new Object()</code><br>
Object的每个实例（原型链中）都具有下列属性和方法：</p> <ul><li>constructor：构造函数，保存用于创建当前对象的函数。</li> <li>hasOwnProperty(param)：用于检查给定的<strong>属性</strong>是否在当前对象实例中（不去原型中找），param为字符串形式。</li> <li>toString()：返回对象的字符串表示。</li> <li>valueOf()：返回对象的字符串、数值或布尔值表示，通常与toString()相同。</li></ul> <h3 id="typeof和instanceof"><a href="#typeof和instanceof" class="header-anchor">#</a> typeof和instanceof</h3> <p>typeof用来判断基本数据类型的类型。如typeof(5)，结果为'number'（小写）。<br>
特殊情况：</p> <ul><li>typeof(null) ：'object'</li> <li>typeof(函数) : 'function'</li></ul> <p>instanceof用来判断引用类型或者自定义类型，会去原型链中查找，直到Object的原型，返回一个布尔值。</p> <h3 id="运算符"><a href="#运算符" class="header-anchor">#</a> == 运算符</h3> <p>除了 == null 之外，其他一律用 ===，如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span>  
<span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>  
<span class="token comment">// 相当于  </span>
<span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> obj<span class="token punctuation">.</span>a <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>  
</code></pre></div><h3 id="eval-函数"><a href="#eval-函数" class="header-anchor">#</a> eval()函数</h3> <ul><li>相当于解析器，接收一个参数，即要执行的<strong>js字符串</strong></li> <li>eval()中创建的任何变量或函数都不会提升，只在eval()执行时创建</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;alert('i')&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 等价于alert('i')  </span>

<span class="token comment">// 创建变量和函数  </span>
<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;var msg = 'hello'; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token function">alert</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  <span class="token comment">// hello，外部可以正常引用  </span>

<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;function test(){ console.log('hi')} &quot;</span><span class="token punctuation">)</span>  
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// hi  </span>
</code></pre></div><h3 id="object-defineproperty"><a href="#object-defineproperty" class="header-anchor">#</a> Object.defineProperty()</h3> <ul><li>用于修改属性默认的特性</li> <li>接收三个参数 - 对象、属性名、描述符对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  
    writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// 表示只读，不可再重新赋值  </span>
    value<span class="token operator">:</span> <span class="token string">'z'</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span>   <span class="token comment">// z  </span>
</code></pre></div><p><strong>访问器属性</strong></p> <ul><li>访问器属性是对象中的一个隐藏属性，但不包含数据值</li> <li>拥有getter和setter函数，读取属性会调用getter，写入会调用setter</li> <li>不可直接定义，必须使用Object.defineProperty()来定义</li> <li>常见使用方式：设置对象中一个属性的值会导致其他属性发生变化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>  
    _year<span class="token operator">:</span> <span class="token number">2008</span><span class="token punctuation">,</span>  
    edition<span class="token operator">:</span> <span class="token number">1</span>  
<span class="token punctuation">}</span>  

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">&quot;year&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_year<span class="token punctuation">;</span>   <span class="token comment">// _是一种记号，表示只能通过对象方法访问的属性  </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// newVal就是year新值，因为这里就是针对year的defineProperty  </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>newVal <span class="token operator">&gt;</span> <span class="token number">2008</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>_year <span class="token operator">=</span> newVal<span class="token punctuation">;</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>edition <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

book<span class="token punctuation">.</span>year <span class="token operator">=</span> <span class="token number">2009</span><span class="token punctuation">;</span>   <span class="token comment">// 设置新值  </span>
<span class="token function">alert</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>edition<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 2，设置了year的值结果导致edition发生变化  </span>
</code></pre></div><h2 id="this指针和原型"><a href="#this指针和原型" class="header-anchor">#</a> this指针和原型</h2> <h3 id="this指针"><a href="#this指针" class="header-anchor">#</a> this指针</h3> <p>解析器在调用函数时，每次会传递进去一个隐含的参数，即this，this指向的是一个对象，这个对象称为函数执行时的上下文对象。根据函数调用方式的不同，this会指向不同的对象。<br>
注意：<strong>this的值是在函数执行的时候确定的</strong>，不是定义的时候确定的。</p> <ol><li>以函数形式调用时，this永远都是window。如：fun（），this为window</li> <li>以方法形式调用时，this是调用方法的那个对象。如：obj.show（），this为obj。即谁调用函数，this就指向谁，window也是一个对象。</li> <li>以构造函数形式调用时，this为新创建的对象。</li> <li>使用call（）和apply（）时，this是第一个参数指向的那个对象</li> <li>箭头函数中的this根据上下文得到，取上级作用域的值</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name<span class="token operator">:</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>  
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token comment">// *注意：this === window  </span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>  
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name<span class="token operator">:</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>  
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
            <span class="token comment">// *注意：箭头函数，this === person  </span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>  
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><h3 id="原型"><a href="#原型" class="header-anchor">#</a> 原型</h3> <p><strong>原型和原型链</strong><br>
实例、构造函数和原型对象三者关系：</p> <ul><li>每个构造函数都有一个原型对象，通过prototype指针指向原型对象</li> <li>原型对象内部有一个指针（constructor）指向构造函数</li> <li>每个实例有一个指针（<code>__proto__</code>)指向原型对象，注意实例中没有指针指向构造函数</li></ul> <p><strong>原型规则</strong><br>
获取实例属性或实例方法时，<br>
先从实例自身寻找，若没有，则去原型中查找（<code>__proto__</code>）<br>
然后原型对象中也存在一个隐式原型（<code>__proto__</code>），直到找到Object的原型，即<code>Object.protytype</code>。（注：Object.prototype的__proto__指向null）</p> <p><strong>相关方法：</strong></p> <ol><li><code>isPrototypeOf</code>：判断对象是否是某实例的原型对象<br> <code>Person.protoype.isPrototypeOf(person) // true</code></li> <li><code>hasOwnProperty</code>：检测一个属性是否在实例中，不去原型中找<br> <code>person.hasOwnProperty(name) // true</code></li> <li><code>in</code>：检测一个属性是否在实例或者原型中<br> <code>&quot;name&quot; in Person</code></li> <li><code>Object.keys()</code>：获得对象上所有可枚举的实例属性，返回数组,不去原型中找<br> <code>var keys = Object.keys(person)</code></li> <li><strong>Object.create()：创建一个新的空对象</strong> <ul><li>const obj2 = new Object(obj1)，则obj1 === obj2</li> <li>Object.create(null)没有原型，也没有其他属性</li> <li>Object.create({...})可指定原型，即参数放在原型中</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>  
    a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  
    b<span class="token operator">:</span> <span class="token number">20</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  
    b<span class="token operator">:</span> <span class="token number">20</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 此时obj1 != obj2，若使用obj2=new Object(obj1)，则obj1===obj2  </span>


<span class="token keyword">const</span> obj3 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// obj3没有属性和原型  </span>
<span class="token keyword">const</span> obj4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// obj4有原型  </span>

<span class="token keyword">const</span> obj5 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  
    b<span class="token operator">:</span> <span class="token number">20</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// 此时obj5为{}，但是obj5有原型，obj.a === 10  </span>

<span class="token keyword">const</span> obj6 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此时同obj5，然后obj6.__proto__ === obj1  </span>
</code></pre></div></li> <li><strong>Object.assign()：实现浅拷贝</strong><br> <code>Object.assign()</code>可以把任意多个源对象自身的可枚举属性拷贝给目标对象再返回，第一个参数即为目标对象<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>job<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span>interest<span class="token operator">:</span> <span class="token string">'study'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  

<span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">// {name: &quot;z&quot;, age: 25, job: &quot;none&quot;}  </span>

Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>obj3<span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">// obj3: {name:&quot;z&quot;, age:25, interest:'study'}  </span>
</code></pre></div></li></ol> <h2 id="作用域"><a href="#作用域" class="header-anchor">#</a> 作用域</h2> <h3 id="自由变量"><a href="#自由变量" class="header-anchor">#</a> 自由变量</h3> <ul><li>一个变量在当前作用域没有定义，但被使用了</li> <li>则向上级作用域，一层一层寻找</li> <li>若没找到，则报错<code>xxx is not defined</code></li></ul> <h3 id="var-let-const"><a href="#var-let-const" class="header-anchor">#</a> var let const</h3> <ul><li>建议使用优先级：const &gt; let &gt; var</li> <li>声明const常量，则变量不能被修改，防止意外修改错误，另外js编译器对const也作了优化，可以提高代码执行效率</li> <li>let和var相比，先声明后使用更加规范，同时产生块级作用域</li> <li>let一般用于基础数据类型，const一般用于引用数据类型，像函数对象和数组等</li> <li>注：const用于引用数据类型保存的是变量地址，所以引用类型中的值是可以改变的</li></ul> <h2 id="创建对象与设计模式"><a href="#创建对象与设计模式" class="header-anchor">#</a> 创建对象与设计模式</h2> <h3 id="工厂模式"><a href="#工厂模式" class="header-anchor">#</a> 工厂模式</h3> <p>使用函数来封装创建对象过程的细节，传入相应参数即可创建对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    obj<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
    obj<span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
    obj<span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>  
    obj<span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">&quot;superman&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p>优点：创建多个相似对象时结构更加清晰<br>
缺点：无法知道一个对象的类型</p> <h3 id="构造函数模式"><a href="#构造函数模式" class="header-anchor">#</a> 构造函数模式</h3> <p>像Object属于原生构造函数，还可以自定义函数作为构造函数，其中自定义对象类型的属性和方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>job<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">&quot;superman&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p><strong>特征：</strong><br>
（1）构造函数函数名大写<br>
（2）直接将属性和方法赋值给了this对象<br>
（3）需要使用 new 操作符，同时不需要return语句<br> <strong>new操作符调用构造函数创建实例步骤：</strong><br>
（1）创造一个新的对象<br>
（2）将该对象链接到构造函数的原型（变成原型的实例对象）<br>
（3）this指针指向该对象，并执行构造函数，添加属性和方法<br>
（4）返回该对象<br>
使用构造函数可以将一个对象标识成一种特定的类型（优于工厂模式），而且对象的constuctor（构造函数）属性指向该构造函数，例如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>person<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">;</span>  <span class="token comment">// true  </span>
person<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Object<span class="token punctuation">;</span>  <span class="token comment">// true  </span>

person instanceOf Person<span class="token punctuation">;</span>  <span class="token comment">// true  </span>
person instanceOf Object<span class="token punctuation">;</span>  <span class="token comment">// true  </span>
</code></pre></div><h3 id="原型模式"><a href="#原型模式" class="header-anchor">#</a> 原型模式</h3> <p><strong>使用对象字面量重写原型：</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>  
    constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>  <span class="token comment">// 设置constructor属性指向Person，这时该属性可以被枚举了  </span>
    name<span class="token operator">:</span> <span class="token string">&quot;zz&quot;</span><span class="token punctuation">,</span>  
    age<span class="token operator">:</span> <span class="token string">&quot;25&quot;</span><span class="token punctuation">,</span>  
    <span class="token function-variable function">print</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>注：重写了原型之后constructor属性不再指向Person，指向Object，要想指向Person可以手动设置该属性。<br>
问题：共享的引用类型值可以被所有的实例对象同步修改</p> <h3 id="组合构造函数和原型模式"><a href="#组合构造函数和原型模式" class="header-anchor">#</a> 组合构造函数和原型模式</h3> <p>使用构造函数定义实例属性，共享的属性和函数放在原型中，解决引用类型值问题</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Jack&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lucy&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 引用类型放在构造函数中  </span>
<span class="token punctuation">}</span>  
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>  
    constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>  
    <span class="token function-variable function">print</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><h2 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h2> <p>子类继承父类的属性和方法，ES5中没有类的概念，因此主要通过原型链实现，这里简单称为子类和父类。<br>
默认的原型：<code>Object.prototype</code></p> <h3 id="原型链继承"><a href="#原型链继承" class="header-anchor">#</a> 原型链继承</h3> <p>核心在于<strong>让子类的原型对象成为父类的一个实例对象</strong>，这时该原型对象的prototype指针就指向了父类的原型对象，也可以称为原型链链接</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token comment">// 继承Parent  </span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p>问题：包含引用类型的原型属性会被所有实例共享<br>
创建子类时不能向父类的构造函数传递参数</p> <h3 id="构造函数继承"><a href="#构造函数继承" class="header-anchor">#</a> 构造函数继承</h3> <p>子类构造函数中调用父类构造函数，请记住：<strong>函数只是在特定环境中执行代码的对象，使用call()和apply()在新对象中执行构造函数</strong>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pink&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name  
<span class="token punctuation">}</span>  
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 继承父类，而且还能传递name参数  </span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
person<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// true  </span>
person<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;yellow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// [&quot;red&quot;, &quot;pink&quot;, &quot;yellow&quot;]  </span>
</code></pre></div><p>问题：方法都需要在构造函数中定义，所以无法复用</p> <h3 id="组合继承"><a href="#组合继承" class="header-anchor">#</a> 组合继承</h3> <p>原型链 + 构造函数，方法定义在原型对象中</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 继承属性  </span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token comment">// 继承方法  </span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child<span class="token punctuation">;</span>   
</code></pre></div><p>注：经过以上继承，<strong>子类继承了父类的实例属性，继承了原型对象的方法</strong>。</p> <h3 id="原型式继承"><a href="#原型式继承" class="header-anchor">#</a> 原型式继承</h3> <p>给定一个对象，将其作为原型，然后生成新的对象，使用Object.create()实现：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name <span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
    colors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// person作为obj原型  </span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>  

obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> person<span class="token punctuation">;</span>   <span class="token comment">// true，此时obj为{}  </span>
obj<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;yellow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &quot;red&quot;,&quot;green&quot;,&quot;yellow&quot;，person中colors也会改变  </span>
</code></pre></div><p>如上所示，person为给定的一个对象，作为原型对象，然后使用<code>Object.create()</code>生成一个新的对象赋给obj，obj的__proto__指针即指向person</p> <h3 id="寄生式继承"><a href="#寄生式继承" class="header-anchor">#</a> 寄生式继承</h3> <p>在原型式继承的基础上，封装一个函数，在函数内部增强对象再返回</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装继承函数  </span>
<span class="token keyword">function</span> <span class="token function">inherit</span><span class="token punctuation">(</span><span class="token parameter">origin</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">var</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 原型式继承  </span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 增强对象功能  </span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;print&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword">return</span> clone<span class="token punctuation">;</span>  <span class="token comment">// 返回对象  </span>
<span class="token punctuation">}</span>  

<span class="token comment">// 调用继承函数  </span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>  
    name <span class="token operator">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>  
    colors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">inherit</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><p>问题：函数无法复用</p> <h3 id="寄生组合式继承"><a href="#寄生组合式继承" class="header-anchor">#</a> 寄生组合式继承</h3> <p>使用原型式继承来继承父类原型，封装函数，再将结果赋给子类原型</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">inheritProto</span><span class="token punctuation">(</span><span class="token parameter">child<span class="token punctuation">,</span> parent</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">var</span> protoype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 继承父类原型  </span>
    <span class="token comment">// 然后将其作为子类原型  </span>
    child<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>    <span class="token comment">/// 使用指针链接  </span>
    prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> child<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>高效、只调用一次构造函数，也可以使用引用类型。</p> <h3 id="es6继承"><a href="#es6继承" class="header-anchor">#</a> ES6继承</h3> <p>ES6引入了class，使用extends实现继承，super()执行父类构造方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>  
    <span class="token comment">// 构造方法  </span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> number  
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;animal&quot;</span>  
    <span class="token punctuation">}</span>  
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">size</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">+</span> <span class="token string">' is '</span> <span class="token operator">+</span> size<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>  
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> food</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// super传入number，传给父类的constructor去执行  </span>
        <span class="token comment">// 注意super中的参数来自constructor，constructor参数是外部传进来的  </span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>food <span class="token operator">=</span> food  
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;cat&quot;</span>  
    <span class="token punctuation">}</span>  
    <span class="token comment">// 增加子类新方法  </span>
    <span class="token function">newPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">new print: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;fish&quot;</span><span class="token punctuation">)</span>  
cat<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;small&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// 调用的是父类方法  </span>
cat<span class="token punctuation">.</span><span class="token function">newPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 子类新方法  </span>
</code></pre></div><p>以上代码中，使用class关键字定义了一个Animal类，其中有一个<code>constructor()</code> 方法即为构造方法。<br>
然后再定义一个<strong>Cat</strong>类，<br> <code>extends</code>用来实现继承，<br> <code>super()</code>用来执行父类构造方法，<br>
然后子类中可以自己重写父类方法或扩展新方法。</p> <h2 id="数据api"><a href="#数据api" class="header-anchor">#</a> 数据API</h2> <p><strong>纯函数</strong></p> <ol><li>不改变原数组</li> <li>返回一个数组</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// concat  </span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span>  
<span class="token keyword">const</span> arr1 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  

<span class="token comment">// map  </span>
<span class="token keyword">const</span> arr2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>  

<span class="token comment">// filter  </span>
<span class="token keyword">const</span> arr3 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span>  

<span class="token comment">// slice  </span>
<span class="token keyword">const</span> arr4 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 相当于一次浅拷贝  </span>
<span class="token comment">// arguments转换为数组  </span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> Array<span class="token punctuation">.</span>protytype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>  
</code></pre></div><h2 id="高级技巧"><a href="#高级技巧" class="header-anchor">#</a> 高级技巧</h2> <h3 id="安全的类型检测"><a href="#安全的类型检测" class="header-anchor">#</a> 安全的类型检测</h3> <p>很多类型检测并不准确，会存在各种各样的问题。这里使用Object原生的toString()方法实现类型检测。<br>
任何值上调用Object原生toString()方法都会返回一个[Object NativeConstructorName]。使用这一特性可封装检测函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 检测数组  </span>
<span class="token keyword">function</span> <span class="token function">isArray</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;[Object Array]&quot;</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// 检测函数  </span>
<span class="token keyword">function</span> <span class="token function">isFunction</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;[Object Function]&quot;</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre></div><h3 id="函数柯里化"><a href="#函数柯里化" class="header-anchor">#</a> 函数柯里化</h3> <p>柯里化是一种将使用多个参数的函数转换成一系列使用一个参数的函数的技术。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token comment">// 一次传入两个参数  </span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5  </span>

<span class="token comment">// 假设有一个curry函数进行柯里化  </span>
<span class="token keyword">var</span> curryAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5  </span>
</code></pre></div><p><strong>柯里化函数创建</strong><br>
调用一个函数，传入要柯里化的函数和必要参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 得到剩余的参数  </span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token comment">// 得到调用函数时新传入的参数  </span>
        <span class="token keyword">var</span> newArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 最终所有参数  </span>
        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> finalArgs<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><p>以上实现中apply的参数为null，因为没有考虑到执行环境，调用如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">var</span> curryAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这里的5就是实现中得到的args  </span>
<span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 8，这里的3即是传入的新的参数newArgs  </span>
</code></pre></div><p>由以上代码可以看出，当curryAdd函数参数达到两个时，参数拼接后可以执行。因此，函数柯里化本质就是<strong>创建一个闭包，保存参数，当参数数量达到函数执行要求时，执行函数</strong>。<br> <strong>bind()函数：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind1</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>  
    <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
         <span class="token keyword">return</span> <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>  
    <span class="token keyword">return</span> <span class="token string">'fn1'</span>  
<span class="token punctuation">}</span>  
<span class="token keyword">const</span> fn2 <span class="token operator">=</span> fn1<span class="token punctuation">.</span><span class="token function">bind1</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>  
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><h2 id="dom"><a href="#dom" class="header-anchor">#</a> DOM</h2> <p>DOM的本质是一棵树，是浏览器根据HTML进行解析得到的一棵树。</p> <h3 id="获取dom结点"><a href="#获取dom结点" class="header-anchor">#</a> 获取DOM结点</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 元素  </span>
<span class="token keyword">const</span> divList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 集合  </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>divList<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>divList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token keyword">const</span> containerList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 集合  </span>
<span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 集合，根据css选择器格式选择  </span>
</code></pre></div><h3 id="property和attribute"><a href="#property和attribute" class="header-anchor">#</a> property和attribute</h3> <ul><li>property：修改对象属性，如宽度，颜色等，不会体现到HTML结构中</li> <li>attribute：修改HTML属性，会改变HTML结构</li> <li>两者都可能引起DOM重新渲染，一般修改property</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> p1 <span class="token operator">=</span> pList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  

<span class="token comment">// property  </span>
p1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'200px'</span>  
p1<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'color'</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>className<span class="token punctuation">)</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span>  

<span class="token comment">// attribute  </span>
p1<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'new-attr'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 添加了一个新的标签属性，和class、type等类型  </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'new-attr'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
p1<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token string">'font-size: 50px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将style属性值设置为字体50px  </span>
</code></pre></div><h3 id="dom结构操作"><a href="#dom结构操作" class="header-anchor">#</a> DOM结构操作</h3> <p><strong>创建新节点：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> div2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// 新建节点  </span>
<span class="token keyword">const</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>  
p<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'new p'</span>  
<span class="token comment">// 插入新节点  </span>
div1<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// 移动节点，原节点移动位置  </span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span>  
div2<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 原div1中p1移动到div2中  </span>
</code></pre></div><p><strong>获取父元素和子元素列表：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取父元素parentNode  </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span>  

<span class="token comment">// 获取子元素列表childNodes  </span>
<span class="token keyword">const</span> divChild <span class="token operator">=</span> div1<span class="token punctuation">.</span>childNodes  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>divChild<span class="token punctuation">)</span>  <span class="token comment">// 注意，这里包含了全部子元素，比如文本也属于子元素，因此需要过滤  </span>
<span class="token comment">// 先转换为数组再过滤  </span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>divChild<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> child<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>  
</code></pre></div><p><strong>删除子元素：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>div<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>pList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><h3 id="dom性能"><a href="#dom性能" class="header-anchor">#</a> DOM性能</h3> <ul><li>DOM操作非常耗时，避免频繁进行DOM操作</li> <li>对DOM查询做缓存</li> <li>将频繁操作（如插入节点）合并为一次性操作</li></ul> <p>DOM查询做缓存：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 每次循环都要进行length计算  </span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 操作  </span>
<span class="token punctuation">}</span>  

<span class="token comment">// 缓存length  </span>
<span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> length <span class="token operator">=</span> pList<span class="token punctuation">.</span>length<span class="token punctuation">;</span>  <span class="token comment">// 缓存length，只进行一次DOM查询  </span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 操作  </span>
<span class="token punctuation">}</span>  
</code></pre></div><p>频繁操作改为一次性操作：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> listNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span>  

<span class="token comment">// 创建一个文档片段  </span>
<span class="token keyword">const</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// 多个节点插入文档片段，此时未插入DOM树  </span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">const</span> l1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>  
    li<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">item </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>  
    frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// 一次性插入到DOM  </span>
listNode<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><h3 id="window对象和document对象"><a href="#window对象和document对象" class="header-anchor">#</a> window对象和document对象</h3> <ul><li>window对象：表示浏览器中打开的窗口</li> <li>document对象：代表给定浏览器窗口中的HTML文档</li> <li>document对象可以通过window对象的document属性引用，其他还有location对象等</li> <li>所以，document中的事件可以冒泡到window</li></ul> <h3 id="load事件与domcontentloaded事件"><a href="#load事件与domcontentloaded事件" class="header-anchor">#</a> load事件与DOMContentLoaded事件</h3> <ul><li>当DOM加载完成，形成完整DOM树时触发DOMContentLoaded事件，不包括样式表、图片或者引入的外部脚本等。</li> <li>页面中的所有DOM、样式表、图片、脚本都加载完成后，load事件触发。</li> <li>一般在DOMContentLoaded事件完成后添加事件处理程序，用户可以更早与页面进行交互</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在DOMContentLoaded事件完成后添加事件处理程序，用户可以更早与页面进行交互  </span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 事件处理  </span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;COMContentLoaded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><h2 id="bom"><a href="#bom" class="header-anchor">#</a> BOM</h2> <p><strong>1. navigator</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent  
<span class="token keyword">const</span> isChrome <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Chrome'</span><span class="token punctuation">)</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isChrome<span class="token punctuation">)</span>  
</code></pre></div><p><strong>2. screen</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span>width<span class="token punctuation">)</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span>height<span class="token punctuation">)</span>  
</code></pre></div><p><strong>3. location</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>location<span class="token punctuation">.</span>href     <span class="token comment">// 当前网址  </span>
location<span class="token punctuation">.</span>protocal   <span class="token comment">// 网络协议http等  </span>
location<span class="token punctuation">.</span>pathname   <span class="token comment">// 网址路径  </span>
</code></pre></div><p><strong>4. history</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// 前进  </span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 后退  </span>
</code></pre></div><h2 id="事件机制"><a href="#事件机制" class="header-anchor">#</a> 事件机制</h2> <h3 id="事件触发"><a href="#事件触发" class="header-anchor">#</a> 事件触发</h3> <ul><li>window往事件触发处传播，称为事件捕获，直到遇到注册的事件层</li> <li>执行注册的事件</li> <li>从事件触发处向window传播，称为事件冒泡，遇到注册的冒泡事件会触发</li></ul> <h3 id="事件绑定"><a href="#事件绑定" class="header-anchor">#</a> 事件绑定</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn1'</span><span class="token punctuation">)</span>  
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取触发的元素btn1  </span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment">// 简单的事件绑定函数  </span>
<span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>  
<span class="token function">bindEvent</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 阻止默认行为，如链接默认点击会跳转，加上就不会产生跳转  </span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cliked'</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="事件冒泡"><a href="#事件冒泡" class="header-anchor">#</a> 事件冒泡</h3> <p>事件冒泡指事件在DOM中一层一层向外触发，外层DOM都可以监听到该事件，一直到body。</p> <ul><li>基于DOM树形结构</li> <li>事件会顺着触发元素往上冒泡</li> <li>应用：事件代理</li></ul> <p><code>e.stopPropagation()</code>可以阻止冒泡。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span>  
p1<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    cosnole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token keyword">const</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body  
<span class="token function">bindEvent</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'over'</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><h3 id="事件代理"><a href="#事件代理" class="header-anchor">#</a> 事件代理</h3> <p>基于事件冒泡，将父元素绑定一个事件，点击多个子元素时，通过冒泡父元素获取到该事件，<strong>通过事件对象获取相应元素</strong>，再进行事件处理。<br>
优点：</p> <ul><li>代码简洁</li> <li>减少浏览器内存占用</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>div1<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>点击加载更多<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>  
    点击增加一个a标签  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span>  
<span class="token function">bindEvent</span><span class="token punctuation">(</span>div1<span class="token punctuation">,</span> <span class="token string">'clicked'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 防止a跳转（到#号）  </span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>  <span class="token comment">// 获取DOM元素  </span>
    <span class="token comment">// 通过DOM API进行处理，获取a标签  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token function">alert</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>  <span class="token comment">// 输出a标签的内容  </span>
    <span class="token punctuation">}</span>  

<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通用的事件绑定函数（支持普通绑定和代理绑定）  </span>
<span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> type<span class="token punctuation">,</span> selector<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token comment">// 如果传三个参数，说明selector不存在  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fn <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
        fn <span class="token operator">=</span> selector  
        selector <span class="token operator">=</span> <span class="token keyword">null</span>  
    <span class="token punctuation">}</span>  
    ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
        <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>  <span class="token comment">// 获取触发的元素  </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token comment">// selector存在，说明是代理绑定  </span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 判断一个DOM元素是否符合CSS选择器  </span>
                <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// call是为了改变this  </span>
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">else</span><span class="token punctuation">{</span>  
            <span class="token comment">// 普通绑定  </span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// 调用  </span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span>  
<span class="token comment">// 这时候不能用箭头函数，因为this要被改变  </span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>div1<span class="token punctuation">,</span> <span class="token string">'clicked'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 直接写参数a  </span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 变成this  </span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>  
</code></pre></div><p>应用举例：如何监听图片列表中各个图片的点击？</p> <ul><li>事件代理</li> <li>使用e.target获取触发元素</li> <li>使用matches来判断是否是图片，再处理</li></ul> <h2 id="垃圾回收机制"><a href="#垃圾回收机制" class="header-anchor">#</a> 垃圾回收机制</h2> <p>首先，Javascript会周期性找出那些不再用到的变量，然后释放其内存。<br>
各大浏览器通常采用的垃圾回收机制有两种方法：标记清除、引用计数。</p> <h3 id="标记清除"><a href="#标记清除" class="header-anchor">#</a> 标记清除</h3> <ul><li>声明变量，则变量标记为“进入环境”，变量离开环境时，如函数执行完成，标记为“离开环境”</li> <li>垃圾回收机制会给所有内存中的变量加上标记，然后去掉处在环境中或是闭包中的变量标记</li> <li>下一个周期运行时，即把带有标记的变量内存回收掉</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token comment">//被标记&quot;进入环境&quot;  </span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>    <span class="token comment">//被标记&quot;进入环境&quot;  </span>
<span class="token punctuation">}</span>  
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//执行完毕后之后，a和b又被标记&quot;离开环境&quot;，被回收  </span>
</code></pre></div><h3 id="引用计数"><a href="#引用计数" class="header-anchor">#</a> 引用计数</h3> <ul><li>语言引擎中有一张“引用表”，保存了内存中的资源引用次数</li> <li>若一个值的引用次数为0，表示不再用到，则将其内存释放</li> <li>如果一个值不需要了，但引用数不为0，则无法释放，从而导致内存泄漏，这时候要手动解除引用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 这里[1,2,3,4]会占用内存，arr引用它，次数为1  </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 未使用arr，但数组被arr引用，无法释放  </span>

arr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// 手动解除引用  </span>
</code></pre></div><h3 id="内存泄漏"><a href="#内存泄漏" class="header-anchor">#</a> 内存泄漏</h3> <ul><li>持续运行的服务进程，必须及时释放内存，否则内存占用持续升高，影响系统性能甚至崩溃</li> <li>不再用到的内存，若没有及时释放，就叫做内存泄漏</li> <li>大多数语言提供自动内存管理，但有些如c语言需要手动释放内存</li></ul> <p><strong>识别内存泄漏</strong><br>
经验：若连续五次垃圾回收后，内存占用一次比一次大，则出现内存泄漏，这时候要实时查看内存占用。<br>
使用Chrome浏览器查看内存占用：</p> <ul><li>开发者工具，选择performance面板</li> <li>顶部的Capture字段中勾选Memory</li> <li>点击左上角的录制按钮</li> <li>页面中进行各种操作，模拟用户的使用情况，还可以点击回收内存</li> <li>一段时间后，点击stop按钮，面板上就会显示这段时间内存占用情况</li> <li>若内存占用基本平稳，接近水平，说明不存在内存泄露，否则需要检查代码排查问题</li></ul> <h3 id="weakmap和weakset"><a href="#weakmap和weakset" class="header-anchor">#</a> WeakMap和WeakSet</h3> <ul><li>我们经常忽略一些引用的清除，如果有一种方法，让我们只需要清除主要引用，次要引用会自动忽略就好了</li> <li>ES6推出WeakSet和WeakMap，它们对值的引用都是不计入垃圾回收机制的，weak就表示弱引用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> wm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 新建WeakMap实例  </span>
<span class="token keyword">const</span> ele <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'example'</span><span class="token punctuation">)</span>  

wm<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>  <span class="token comment">// 这里的引用即为弱引用，不会被计入垃圾回收机制  </span>
wm<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span>  <span class="token comment">// 'value'，一旦消除对ele的引用，则wm中的键值对也会被回收  </span>
</code></pre></div><p>因此，如果想向map中添加数据，又不想干扰垃圾回收机制，就可以使用WeakMap。</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/myBlog/assets/js/app.e2a5d604.js" defer></script><script src="/myBlog/assets/js/3.8a7523f6.js" defer></script><script src="/myBlog/assets/js/1.015dc369.js" defer></script><script src="/myBlog/assets/js/52.c3bc0832.js" defer></script>
  </body>
</html>
